# ინვოისების მოდული

## სარჩევი
1. [კონცეპტუალური მიმოხილვა](#კონცეპტუალური-მიმოხილვა)
  * [სტატუსები](#სტატუსები)
  * [ტიპები](#სტატუსები)
  * [გაგზავნა](#გაგზავნა)
  * [ინვოისის შაბლონი](#ინვოისის-შაბლონი)
  * [განმეორებადი დავალება](#განმეორებადი-დავალება)
2. [იმპლემენტაცია](#იმპლემენტაცია)
  * [ბაზის დონეზე](#იმპლემენტაცია-ბაზის-დონეზე)
  * [API-ის დონეზე](#იმპლემენტაცია-API-ის-დონეზე)
  * [UI/UX-ის დონეზე](#იმპლემენტაცია-UI/UX-ის-დონეზე)
<!-- 3. [ობიექტები](#ობიექტები)
  * [User](#User)
  * [Company](#Company)
  * [Customer](#Customer)
  * [Product](#Product)
  * [Invoice](#Invoice)
  * [Invoice Template](#Invoice-Template)
  * [Recurring](#Recurring)
  * [Payment](#Payment) -->

## კონცეპტუალური მიმოხილვა

`Invoice` - ინვოისი არის დოკუმენტი, რომელსაც გამყიდველი/გამგზავნი (`Company`) ქმნის და, რომელიც, განკუთვნილია მყიდველისთვის/მიმღებისთვის (`Customer`).

ინვოისი შეიცავს დეტალების ცხრილს, რომლის თითოეული ხაზი (ჩანაწერი) არის ინფორმაცია რაიმე პროდუქტის ან მომსახურების შესახებ (`Product`).

ინვოისი შეიძლება შეიქმნას
* InvoiceWave-ის ვებ ინტერფეისიდან (`manual`, `one-off` ინვოისი)
* API-ის მეშვეობით (`manual`, `one-off` ინვოისი)
* ავტომატურად `recurring` კონფიგურაციასა და `invoice template`-ზე დაყრდნობით (`automatic` ინვოისი)


#### სტატუსები:
ინვოისს შესაძლოა ჰქონდეს შემდეგი სტატუსები:
* `draft` - შენახული ინვოისი, რომელიც ჯერ არ არის გახსნილი, ჯერ არ არის განხილული, როგორც მყიდველამდე მისული. ამ დონეზე ინვოისი ძალაში არ შესულა და, ამდენად, ჯერ კიდევ შეიძლება მისი ნებისმიერად რედაქტირება ან წაშლა.
* `open` - ინვოისი, რომელიც უკვე ძალაშია შესული და შესაბამის გადახდას (`payment`-ს) მოელის. ამ დონეზე ინვოისის წაშლა არ შეიძლება, შესაძლოა მისი გადახდა, გაგზავნა და/ან განულება/შეჩერება.
* `paid` - დასრულებული ინვოისი, რომელიც სრულად არის გადახდილი. ამ დონეზე მოცემულ ინვოისზე რაიმე ოპერაციის განხორციელება, რაც სტატუსების შეცვლას იწვევს, არ არის შესაძლებელი.
* `void` - განულებული/შეჩერებული ინვოისი. თუ მომხმარებელმა ძალაში შეიყვანა ინვოისი, ვეღარ წაშლის. საჭიროა, რომ შეაჩეროს/გაანულოს. ასეთ შემთხვევაში ინვოისს დაესმევა `void` სტატუსი. ამ სტატუსის აღსანიშნავად შესაძლოა `canceled` ტერმინის გამოყენებაც.

#### გაგზავნა:
ინვოისი შესაძლოა გაიგზავნოს

#### ინვოისის შაბლონი:
`Invoice Template` - არის შაბლონი, რომელშიც გაწერილია მონაცემები (`from` - გამგზავნი, `to` - მიმღები, `details`, `sendInformation`, `subtotal`, `discount`, `tax`, `total`), რომლებიც გამოიყენება ინვოისის დასაგენერირებლად.

#### განმეორებადი დავალება
`Recurring` - განმეორებადი დავალება არის კონფიგურაცია, რომელიც საზღვრავს, თუ რა პერიოდულობით უნდა დაგენერირდეს ინვოისები.


## იმპლემენტაცია ბაზის დონეზე

ინვოისის მოდულის დასაკმაყოფილებლად ბაზის დონეზე განსაზღვრულია ორი მოდელი (კოლექცია): **Invoice** და **Recurring**.

**Invoice** კოლექციაში ინახება როგორც `Invoice`, ასევე `Invoice Template`. მათ გასასხვავებლად გამოიყენება `type` ველი. თუ კოლექციაში შენახული ობიექტი შაბლონია, მისი `type` იქნება *"template"*, ხოლო თუ ობიექტი ინვოისია, მაშინ მისი `type` იქნება *"invoice"* :)

**Recurring** კოლექციაში ინახება კონფიგურაცია, რომელიც საზღვრავს, თუ რა პერიოდულობით უნდა დაგენერირდეს ინვოისები.

იმისათვის, რომ `Recurring` სისტემამ სწორად იმუშაოს, საჭირო `Invoice Template`, რომელში შენახული ინფორმაციაც გამოიყენება `Recurring` სისტემის მიერ ავტომატური ინვოისების დასაგენერირებლად. ამდენად, თითოეული ჩანაწერი **Recurring** კოლექციაში შეიცავს რეფერენციას შაბლონზე (`template` ველის მეშვეობით). ამ ველში ინახება  **Invoice** კოლექციაში შენახული შაბლონის იდენტიფიკატორი (`_id`). შემდგომში შესაძლოა `Invoice Template`-ებისთვის ცალკე მოდელი (კოლექცია) განისაზღვროს და, ასეთ შემთხვევაში, `template` ველი იქნება იდენტიფიკატორი (`_id`) ამჯერად უკვე ცალკე გამოყოფილ **InvoiceTemplate** მოდელში (კოლექციაში) შენახული შაბლონისა.



## იმპლემენტაცია API-ის დონეზე
[TODO]


## იმპლემენტაცია UI/UX-ის დონეზე
[TODO]

<!-- ## ობიექტები

### `User`

### `Company`

### `Customer`

### `Product`

### `Invoice`

### `Invoice Template`

### `Recurring`

### `Payment` -->
